'use client';
"use strict";var e=require("tslib"),t=require("react"),l=require("tailwind-merge");require("../../../contexts/BaseColorContext.cjs");var a=require("../../../contexts/HoveredValueContext.cjs");require("../../../contexts/RootStylesContext.cjs");var r=require("../../../contexts/SelectedValueContext.cjs"),s=require("../../../hooks/useInternalState.cjs"),n=require("../../../hooks/useSelectOnKeyDown.cjs"),i=require("../../../assets/ArrowDownHeadIcon.cjs"),o=require("../../../assets/SearchIcon.cjs"),c=require("../../../assets/XCircleIcon.cjs"),u=require("../../../lib/shape.cjs"),d=require("../../../lib/sizing.cjs"),g=require("../../../lib/spacing.cjs"),m=require("../../../lib/font.cjs"),f=require("../../../lib/theme.cjs"),h=require("../../../lib/utils.cjs"),p=require("../selectUtils.cjs"),C=require("../../util-elements/Modal/Modal.cjs");function w(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var x=w(t);const v=h.makeClassName("MultiSelectBox"),b=x.default.forwardRef(((w,b)=>{const{defaultValue:N,value:E,onValueChange:j,placeholder:q="Select...",disabled:R=!1,icon:S,children:M,className:O,onKeyDown:L}=w,y=e.__rest(w,["defaultValue","value","onValueChange","placeholder","disabled","icon","children","className","onKeyDown"]),z=S,D=t.useRef(null),[T,V]=t.useState(!1),[P,A]=s(N,E),[k,F]=t.useState(""),_=null!=P?P:[],U=_.length>0,X=U?`${_.length} Selected`:q,B=x.default.Children.map(M,(e=>Object.assign({},e.props))),I=p.getFilteredOptions(k,B),K=new Set(I.map((e=>{var t;return null!==(t=e.text)&&void 0!==t?t:e.value}))),H=I.map((e=>e.value)),W=e=>{F(""),V(e)},Y=e=>{let t=[];t=h.isValueInArray(e,_)?[...h.removeValueFromArray(e,_)]:[..._,e],A(t),null==j||j(t)},[$,G]=n(Y,H,T,V);return x.default.createElement("div",Object.assign({ref:h.mergeRefs([D,b]),className:l.twMerge(v("root"),"relative w-full min-w-[10rem]",O),onKeyDown:e=>{G(e),null==L||L(e)}},y),x.default.createElement("button",{type:"button",className:l.twMerge(v("button"),"flex justify-between items-center w-full focus:outline-none focus:ring-2",p.getSelectButtonColors(U,R),h.getColorClassNames("blue",f.colorPalette.lightRing).focusRingColor,u.borderRadius.md.all,u.border.sm.all,u.boxShadow.sm,z?g.spacing.xl.paddingLeft:g.spacing.twoXl.paddingLeft,g.spacing.twoXl.paddingRight,g.spacing.sm.paddingY),onClick:()=>W(!T),disabled:R},x.default.createElement("div",{className:"flex justify-start items-center truncate"},z?x.default.createElement(z,{className:l.twMerge(v("icon"),"shrink-0",d.sizing.lg.height,d.sizing.lg.width,h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor,g.spacing.lg.marginRight),"aria-hidden":"true"}):null,x.default.createElement("p",{className:l.twMerge(v("text"),"whitespace-nowrap truncate",m.fontSize.sm,m.fontWeight.md)},X)),x.default.createElement("div",{className:"flex items-center"},U&&!R?x.default.createElement("div",{role:"button",className:l.twMerge(v("resetButton"),g.spacing.xs.marginRight),onClick:e=>{e.stopPropagation(),A([]),null==j||j([])}},x.default.createElement(c,{className:l.twMerge("flex-none",d.sizing.md.height,d.sizing.md.width,h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor),"aria-hidden":"true"})):null,x.default.createElement(i,{className:l.twMerge("flex-none",d.sizing.lg.height,d.sizing.lg.width,g.spacing.twoXs.negativeMarginRight,h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor),"aria-hidden":"true"}))),x.default.createElement(C,{showModal:T,setShowModal:W,parentRef:D},x.default.createElement("div",{className:l.twMerge("flex items-center w-full",h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.canvasBackground).bgColor,g.spacing.twoXl.paddingX)},x.default.createElement("span",null,x.default.createElement(o,{className:l.twMerge("flex-none",h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor,g.spacing.threeXs.negativeMarginLeft,g.spacing.lg.marginRight,d.sizing.md.height,d.sizing.md.width),"aria-hidden":"true"})),x.default.createElement("input",{name:"search",type:"input",placeholder:"Search",className:l.twMerge("w-full focus:outline-none focus:ring-none",h.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.darkText).textColor,h.getColorClassNames("transparent").bgColor,g.spacing.sm.paddingY,m.fontSize.sm,m.fontWeight.md),onChange:e=>F(e.target.value)})),x.default.createElement(r.Provider,{value:{selectedValue:_,handleValueChange:Y}},x.default.createElement(a.Provider,{value:{hoveredValue:$}},x.default.Children.map(M,(e=>{var t;const l=null!==(t=e.props.text)&&void 0!==t?t:e.props.value;if(K.has(String(l)))return x.default.cloneElement(e)}))))))}));b.displayName="MultiSelectBox",module.exports=b;
