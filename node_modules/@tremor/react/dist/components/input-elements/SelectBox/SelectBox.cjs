'use client';
"use strict";var e=require("tslib"),t=require("react"),l=require("tailwind-merge"),r=require("../../../assets/ArrowDownHeadIcon.cjs"),a=require("../../../hooks/useInternalState.cjs"),n=require("../../../hooks/useSelectOnKeyDown.cjs");require("../../../contexts/BaseColorContext.cjs");var o=require("../../../contexts/HoveredValueContext.cjs");require("../../../contexts/RootStylesContext.cjs");var s=require("../../../contexts/SelectedValueContext.cjs"),u=require("../../../lib/constants.cjs"),i=require("../../../lib/shape.cjs"),c=require("../../../lib/sizing.cjs"),d=require("../../../lib/spacing.cjs"),g=require("../../../lib/font.cjs"),f=require("../../../lib/theme.cjs"),m=require("../../../lib/utils.cjs"),h=require("../selectUtils.cjs"),p=require("../../util-elements/Modal/Modal.cjs");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var C=v(t);const w=m.makeClassName("SelectBox"),x=C.default.forwardRef(((v,x)=>{const{defaultValue:b,value:j,onValueChange:q,placeholder:S="Select...",disabled:N=!1,icon:E,children:M,className:R,onKeyDown:D}=v,V=e.__rest(v,["defaultValue","value","onValueChange","placeholder","disabled","icon","children","className","onKeyDown"]),y=t.useMemo((()=>h.constructValueToNameMapping(M)),[M]),[B,O]=a(b,j),[L,z]=t.useState(y.get(B||"")||""),[P,k]=t.useState(""),[T,F]=t.useState(!1),K=t.useRef(null),_=t.useRef(null),A=E,I=h.hasValue(B);t.useEffect((()=>{void 0!==B&&z(y.get(B)||"")}),[B,y]);const U=C.default.Children.map(M,(e=>Object.assign({},e.props))),H=h.getFilteredOptions(P,U),W=new Set(H.map((e=>{var t;return null!==(t=e.text)&&void 0!==t?t:e.value}))),X=H.map((e=>e.value)),Y=e=>{var t,l;!1===e?null===(t=_.current)||void 0===t||t.blur():(null===(l=_.current)||void 0===l||l.focus(),_.current&&(_.current.selectionStart=_.current.value.length,_.current.selectionEnd=_.current.value.length)),F(e)},G=e=>{var t;k(""),void 0!==e&&z(y.get(e)||""),Y(!1),O(e),null===(t=_.current)||void 0===t||t.blur(),null==q||q(e)},[J,Q]=n(G,X,T,Y,B);return C.default.createElement("div",Object.assign({ref:m.mergeRefs([K,x]),onKeyDown:e=>{Q(e),null==D||D(e)},className:l.twMerge("relative w-full min-w-[10rem]",R)},V),C.default.createElement("button",{className:l.twMerge(w("root"),"flex w-full items-center overflow-hidden cursor-text focus:outline-none focus:ring-2",h.getSelectButtonColors(I,N),T&&l.twMerge("ring-2",m.getColorClassNames(u.BaseColors.Blue,f.colorPalette.ring).ringColor),m.getColorClassNames(u.BaseColors.Blue,f.colorPalette.lightRing).focusRingColor,i.borderRadius.md.all,i.border.sm.all,i.boxShadow.sm),onClick:e=>{Y(!T),e.preventDefault()},disabled:N},A?C.default.createElement(A,{className:l.twMerge(w("icon"),"shrink-0 bg-inherit",c.sizing.lg.height,c.sizing.lg.width,d.spacing.xl.marginLeft,m.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor),"aria-hidden":"true"}):null,C.default.createElement("input",{ref:_,type:"text",className:l.twMerge(w("input"),"w-full focus:outline-none focus:ring-0 bg-inherit",A?d.spacing.lg.paddingLeft:d.spacing.twoXl.paddingLeft,d.spacing.sm.paddingY,g.fontSize.sm,g.fontWeight.md,i.border.none.all,N?"placeholder:text-gray-400":"placeholder:text-gray-500"),placeholder:S,value:L,onChange:e=>{k(e.target.value),z(e.target.value)},onFocus:()=>Y(!0),onMouseDown:e=>e.preventDefault()}),C.default.createElement(r,{className:l.twMerge(w("arrowDownIcon"),"flex-none",c.sizing.lg.height,c.sizing.lg.width,d.spacing.lg.marginRight,m.getColorClassNames(f.DEFAULT_COLOR,f.colorPalette.lightText).textColor),"aria-hidden":"true"})),C.default.createElement(p,{showModal:0!==H.length&&T,setShowModal:Y,parentRef:K},C.default.createElement(s.Provider,{value:{selectedValue:B,handleValueChange:G}},C.default.createElement(o.Provider,{value:{hoveredValue:J}},C.default.Children.map(M,(e=>{var t;const l=null!==(t=e.props.text)&&void 0!==t?t:e.props.value;return W.has(String(l))?C.default.cloneElement(e):null}))))))}));x.displayName="SelectBox",module.exports=x;
